# =============================================================================
# TAGS - Installation type selection
# =============================================================================
tags:
  # -- Install operators using Helm chart dependencies instead of OLM.
  # Set to true when OLM is not available in the cluster.
  # Default is false (use OLM Subscriptions when available).
  install-with-helm-dependencies: false

# -- Skip CRD existence check - render all CRs regardless. Set to true for ArgoCD.
skipCrdCheck: false

# =============================================================================
# OLM - Settings for OLM operator subscriptions
# =============================================================================
olm:
  # -- Install plan approval mode (Automatic or Manual)
  installPlanApproval: Automatic
  # -- Default catalog source for OLM subscriptions
  source: redhat-operators
  # -- Namespace of the catalog source
  sourceNamespace: openshift-marketplace

# -- Common labels applied to all resources
labels: {}

# =============================================================================
# OPERATOR - ODH or RHOAI operator installation
# =============================================================================
operator:
  # -- Enable operator installation
  enabled: true

  # -- Operator type: odh (Open Data Hub) or rhoai (Red Hat OpenShift AI)
  type: odh

  # -- ODH operator settings
  odh:
    monitoringNamespace: opendatahub
    applicationsNamespace: opendatahub

    olm:
      channel: fast-3
      name: opendatahub-operator
      namespace: opendatahub-operator-system
      source: community-operators

  # -- RHOAI operator settings
  rhoai:
    monitoringNamespace: redhat-ods-monitoring
    applicationsNamespace: redhat-ods-applications

    olm:
      channel: fast-3.x
      name: rhods-operator
      namespace: redhat-ods-operator
      source: redhat-operators

# -- Trusted CA bundle configuration
trustedCABundle:
  # -- Management state for trusted CA bundle (Managed or Removed)
  managementState: Managed
  # -- A custom CA bundle that will be available for all components in the Data Science Cluster (DSC).
  customCABundle: ""

services:
  # -- Monitoring service configuration
  monitoring:
    dependencies:
      clusterObservability: true
      opentelemetry: true
      tempo: true
    dsci:
      managementState: Managed
      metrics: {}
      traces: {}
      alerting: {}

# =============================================================================
# COMPONENTS - High-level features that auto-enable their dependencies
# Components configure the DataScienceCluster (DSC) managementState.
# managementState values: Managed (dependencies auto-enabled), Removed (no deps), Unmanaged (kueue only, deps auto-enabled)
#
# Structure:
#   dependencies: Boolean toggles for which dependencies this component needs
#   dsc: Configuration that goes into the DataScienceCluster CR
#   defaults: (optional) Operator-type-specific defaults for dsc fields
# =============================================================================
components:
  # -- AI Pipelines component
  aipipelines:
    # -- Dependencies required by AI Pipelines
    dependencies: {}
    dsc:
      # -- Management state for AI Pipelines (Managed or Removed)
      managementState: Managed
      # argoWorkflowsControllers:
      #   managementState: Managed

  # -- Dashboard component
  dashboard:
    # -- Dependencies required by Dashboard
    dependencies: {}
    dsc:
      # -- Management state for Dashboard (Managed or Removed)
      managementState: Managed

  # -- Feast Operator component
  feastoperator:
    # -- Dependencies required by Feast Operator
    dependencies: {}
    # -- DSC configuration for Feast Operator
    dsc:
      # -- Management state for Feast Operator (Managed or Removed)
      managementState: Managed

  # -- KServe model serving component
  kserve:
    # -- Dependencies required by KServe (set to false to disable)
    dependencies:
      certManager: true
      leaderWorkerSet: true
      jobSet: true
      rhcl: true
      customMetricsAutoscaler: true
    # -- DSC configuration for KServe
    dsc:
      # -- Management state for KServe (Managed or Removed)
      managementState: Managed
      # -- Models as Service configuration
      modelsAsService:
        # -- Management state for Models as Service (Managed or Removed)
        managementState: Removed
      # -- Enables NVIDIA NIM integration
      nim:
        # -- Management state for NIM (Managed or Removed)
        managementState: Managed
      # -- Raw deployment service config for KServe (Headless or Headed)
      rawDeploymentServiceConfig: Headless
    modelsAsService:
      # -- Gateway Class configuration for the LLMInferenceService.
      gatewayClass:
        # -- Flag to create the Gateway Class (auto, true, false). If auto, it will be created if Models as Service is Managed.
        create: false
        name: maas-gateway-class
        spec:
          controllerName: "openshift.io/gateway-controller/v1"
      # -- Gateway configuration for the LLMInferenceService.
      gateway:
        # -- Flag to create the Gateway (auto, true, false). If auto, it will be created if Models as Service is Managed.
        create: false
        name: maas-default-gateway
        namespace: openshift-ingress
        annotations:
          security.opendatahub.io/authorino-tls-bootstrap: "true"
          opendatahub.io/managed: "false"
        spec:
          gatewayClassName: maas-gateway-class
          listeners:
            - name: https
              port: 443
              # hostname: <HOSTNAME> # Uncomment this line to use a specific hostname.
              protocol: HTTPS
              allowedRoutes:
                namespaces:
                  from: All
                  # The following is an example of how to restrict the namespaces to the interested ones.
                  # from: Selector
                  # selector:
                  #   matchExpressions:
                  #   - key: kubernetes.io/metadata.name
                  #     operator: In
                  #     values:
                  #     - openshift-ingress
                  #     - ...
              # tls: # Uncomment this to enable TLS termination for the Gateway.
              #   certificateRefs:
              #   - group: ''
              #     kind: Secret
              #     name: <SECRET_NAME>
              #   mode: Terminate


  # -- Kueue job queuing component
  kueue:
    # -- Dependencies required by Kueue
    dependencies:
      certManager: true
      kueue: true
    # -- DSC configuration for Kueue
    dsc:
      # -- Management state for Kueue (Unmanaged or Removed). Auto-enables: kueue operator
      managementState: Unmanaged
      defaultLocalQueueName: default
      defaultClusterQueueName: default

  # -- Model Registry component
  modelregistry:
    # -- Dependencies required by Model Registry
    dependencies: {}
    # -- DSC configuration for Model Registry
    dsc:
      # -- Management state for Model Registry (Managed or Removed)
      managementState: Managed
      # -- Registries namespace for Model Registry (overrides defaults)
      registriesNamespace:
    # -- Operator-type-specific defaults for dsc fields
    defaults:
      odh:
        registriesNamespace: odh-model-registry
      rhoai:
        registriesNamespace: rhoai-model-registries

  # -- Ray component
  ray:
    # -- Dependencies required by Ray
    dependencies:
      certManager: true
    # -- DSC configuration for Ray
    dsc:
      # -- Management state for Ray (Managed or Removed)
      managementState: Managed

  # -- Trainer component
  trainer:
    # -- Dependencies required by Trainer
    dependencies:
      certManager: true
      jobSet: true
    # -- DSC configuration for Trainer
    dsc:
      # -- Management state for Trainer (Managed or Removed)
      managementState: Managed

  # -- Kubeflow Training Operator component
  trainingoperator:
    # -- Dependencies required by Kubeflow Training Operator
    dependencies: {}
    # -- DSC configuration for Kubeflow Training Operator
    dsc:
      # -- Management state for Kubeflow Training Operator (Managed or Removed)
      managementState: Removed

  # -- TrustyAI component
  trustyai:
    # -- Dependencies required by TrustyAI
    dependencies: {}
    # -- DSC configuration for TrustyAI
    dsc:
      # -- Management state for TrustyAI (Managed or Removed)
      managementState: Managed
      # -- Evaluation configuration for TrustyAI evaluations
      eval:
        lmeval:
          permitCodeExecution: deny
          permitOnline: deny

  # -- Workbenches component
  workbenches:
    # -- Dependencies required by Workbenches
    dependencies: {}
    # -- DSC configuration for Workbenches
    dsc:
      # -- Management state for Workbenches (Managed or Removed)
      managementState: Managed
      # -- Workbench namespace for Workbenches (overrides defaults)
      workbenchNamespace:
    # -- Operator-type-specific defaults for dsc fields
    defaults:
      odh:
        workbenchNamespace: opendatahub
      rhoai:
        workbenchNamespace: rhods-notebooks

  # -- MLflow Operator component
  mlflowoperator:
    # -- Dependencies required by MLflow Operator
    dependencies: {}
    # -- DSC configuration for MLflow Operator
    dsc:
      # -- Management state for MLflow Operator (Managed or Removed)
      managementState: Removed

  # -- LlamaStack Operator component
  llamastackoperator:
    # -- Dependencies required by LlamaStack Operator
    dependencies:
      nfd: true
      nvidiaGPUOperator: true
    # -- DSC configuration for LlamaStack Operator
    dsc:
      # -- Management state for LlamaStack Operator (Managed or Removed)
      managementState: Removed

# =============================================================================
# DEPENDENCIES - Operators required by components
#
# Tri-state enabled:
#   auto  - Install if required by an enabled component (default)
#   true  - Always install
#   false - Never install (user has it already or doesn't want it)
#
# dependencies: Other dependencies this dependency requires (for transitive deps)
# config.spec: CR spec fields (user can add any fields supported by the CR)
# =============================================================================
dependencies:
  # -- Cert Manager operator
  certManager:
    # -- Enable cert-manager: auto (if needed), true (always), false (never)
    enabled: auto
    # -- Dependencies required by cert-manager
    dependencies: {}
    olm:
      channel: stable-v1
      name: openshift-cert-manager-operator
      namespace: cert-manager-operator

  # -- Leader Worker Set operator
  leaderWorkerSet:
    # -- Enable leader-worker-set: auto (if needed), true (always), false (never)
    enabled: auto
    # -- Dependencies required by leader-worker-set
    dependencies:
      certManager: true
    olm:
      channel: stable-v1.0
      name: leader-worker-set
      namespace: openshift-lws-operator
      targetNamespaces:
        - openshift-lws-operator
    config:
      # -- LeaderWorkerSetOperator CR spec
      spec:
        managementState: Managed
        logLevel: Normal
        operatorLogLevel: Normal

  # -- Job Set operator
  jobSet:
    # -- Enable job-set: auto (if needed), true (always), false (never)
    enabled: auto
    # -- Dependencies required by job-set
    dependencies:
      certManager: true
    olm:
      channel: tech-preview-v0.1
      name: job-set
      namespace: openshift-jobset-operator
      targetNamespaces:
        - openshift-jobset-operator
    config:
      # -- JobSetOperator CR spec (user can add any fields supported by the CR)
      spec:
        logLevel: Normal
        operatorLogLevel: Normal

  # -- RHCL (Kuadrant) operator
  rhcl:
    # -- Enable rhcl: auto (if needed), true (always), false (never)
    enabled: auto
    # -- Dependencies required by rhcl
    dependencies:
      certManager: true
      leaderWorkerSet: true
    olm:
      channel: stable
      name: rhcl-operator
      namespace: kuadrant-system
    config:
      # -- Enable Authorino TLS configuration
      tlsEnabled: false
      # -- Kuadrant CR spec (user can add any fields)
      spec: {}
      # -- Authorino CR spec (only created if tlsEnabled: true)
      authorinoSpec:
        replicas: 1
        clusterWide: true
        listener:
          tls:
            enabled: true
            certSecretRef:
              name: authorino-server-cert
        oidcServer:
          tls:
            enabled: false

  # -- Kueue operator
  kueue:
    # -- Enable kueue: auto (if needed), true (always), false (never)
    enabled: auto
    # -- Dependencies required by kueue
    dependencies:
      certManager: true
    olm:
      channel: stable-v1.2
      name: kueue-operator
      namespace: openshift-kueue-operator
    config:
      # -- Kueue CR spec (user can add any fields)
      spec:
        managementState: Managed
        config:
          integrations:
            frameworks:
              - Deployment
              - Pod
              - PyTorchJob
              - RayCluster
              - RayJob
              - StatefulSet
              - TrainJob

  # -- Cluster Observability operator
  clusterObservability:
    # -- Enable cluster-observability: auto (if needed), true (always), false (never)
    enabled: auto
    # -- Dependencies required by cluster-observability
    dependencies:
      opentelemetry: true
    olm:
      channel: stable
      name: cluster-observability-operator
      namespace: openshift-cluster-observability-operator

  # -- OpenTelemetry operator
  opentelemetry:
    # -- Enable opentelemetry: auto (if needed), true (always), false (never)
    enabled: auto
    # -- Dependencies required by opentelemetry
    dependencies: {}
    olm:
      channel: stable
      name: opentelemetry-product
      namespace: openshift-opentelemetry-operator

  # -- Tempo operator
  tempo:
    # -- Enable tempo: auto (if needed), true (always), false (never)
    enabled: auto
    # -- Dependencies required by tempo
    dependencies:
      opentelemetry: true
    olm:
      channel: stable
      name: tempo-product
      namespace: openshift-tempo-operator

  # -- Custom Metrics Autoscaler (KEDA) operator
  customMetricsAutoscaler:
    # -- Enable custom-metrics-autoscaler: auto (if needed), true (always), false (never)
    enabled: auto
    # -- Dependencies required by custom-metrics-autoscaler
    dependencies: {}
    olm:
      channel: stable
      name: openshift-custom-metrics-autoscaler-operator
      namespace: openshift-keda

  # -- Node Feature Discovery operator (required for GPU support)
  nfd:
    # -- Enable NFD: auto (if needed), true (always), false (never)
    enabled: auto
    # -- Dependencies required by NFD
    dependencies: {}
    olm:
      channel: stable
      name: nfd
      namespace: openshift-nfd
      targetNamespaces:
        - openshift-nfd
    # config:
    #   # -- NodeFeatureDiscovery CR spec (user must configure based on their requirements)
    #   # -- See https://docs.openshift.com/container-platform/latest/hardware_enablement/psap-node-feature-discovery-operator.html
    #   spec:
    #     # Example configuration (uncomment and modify as needed):
    #     operand:
    #       image: registry.redhat.io/openshift4/ose-node-feature-discovery-rhel9:v4.19
    #       imagePullPolicy: Always

  # -- NVIDIA GPU operator (required for GPU support)
  nvidiaGPUOperator:
    # -- Enable GPU operator: auto (if needed), true (always), false (never)
    enabled: auto
    # -- Dependencies required by GPU operator
    dependencies:
      nfd: true
    olm:
      channel: v25.10
      name: gpu-operator-certified
      namespace: nvidia-gpu-operator
      source: certified-operators
      targetNamespaces:
        - nvidia-gpu-operator
    # config:
    #   # -- ClusterPolicy CR spec (user must configure based on their requirements)
    #   # -- See https://docs.nvidia.com/datacenter/cloud-native/openshift/latest/index.html
    #   spec:
    #     # Example configuration (uncomment and modify as needed):
    #     operator:
    #       defaultRuntime: crio
    #     daemonsets:
    #       priorityClassName: system-node-critical
    #       tolerations:
    #         - key: nvidia.com/gpu
    #           operator: Exists
    #           effect: NoSchedule
    #       updateStrategy: RollingUpdate
    #     driver:
    #       enabled: true
    #       repository: nvcr.io/nvidia
    #       image: driver
    #       version: "580.65.06"
    #     toolkit:
    #       enabled: true
    #     devicePlugin:
    #       enabled: true
    #     dcgm:
    #       enabled: true
    #     dcgmExporter:
    #       enabled: true
    #     gfd:
    #       enabled: true
    #     migManager:
    #       enabled: true
    #     nodeStatusExporter:
    #       enabled: true
